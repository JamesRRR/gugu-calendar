<view class="page-container">
  <!-- 顶部装饰 -->
  <view class="top-decoration">
    <!-- 移除波浪装饰图，改用渐变背景色 -->
  </view>

  <!-- 头部区域 -->
  <view class="header">
    <view class="header-content">
      <view class="title-section">
        <text class="main-title">我的活动</text>
        <text class="sub-title">{{joinedEvents.length}}个快乐约定</text>
      </view>
      <view class="stats-card">
        <view class="stat-item">
          <text class="stat-num">{{activeEvents}}</text>
          <text class="stat-label">进行中</text>
        </view>
        <view class="stat-divider"></view>
        <view class="stat-item">
          <text class="stat-num">{{completedEvents}}</text>
          <text class="stat-label">已完成</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 活动列表 -->
  <scroll-view scroll-y="true" class="events-container">
    <view class="event-card" 
          wx:for="{{joinedEvents}}" 
          wx:key="_id" 
          bindtap="goToEventDetail" 
          data-id="{{item._id}}">
      <!-- 左侧日期 -->
      <view class="date-section">
        <text class="date-day">{{item.dateDay}}</text>
        <text class="date-month">{{item.dateMonth}}月</text>
      </view>

      <!-- 右侧内容 -->
      <view class="content-section">
        <view class="event-header">
          <text class="event-title">{{item.title}}</text>
          <view class="status-tag {{item.status}}">{{item.statusText}}</view>
        </view>

        <view class="event-info">
          <view class="info-item">
            <text class="cuIcon-time"></text>
            <text class="info-text">{{item.time}}</text>
          </view>
          <view class="info-item">
            <text class="cuIcon-location"></text>
            <text class="info-text">{{item.location}}</text>
          </view>
        </view>

        <view class="event-footer">
          <view class="participants">
            <view class="avatar-group">
              <image class="avatar" 
                     wx:for="{{item.participantAvatars}}" 
                     wx:key="*this" 
                     wx:for-item="avatar"
                     src="{{avatar || '/images/default-avatar.png'}}"
              />
            </view>
            <text class="participant-count">{{item.participants.length}}人参加</text>
          </view>
          <view class="time-remaining {{item.urgent ? 'urgent' : ''}}">
            {{item.timeRemaining}}
          </view>
        </view>
      </view>
    </view>

    <!-- 加载更多 -->
    <view class="loading-more" wx:if="{{hasMore}}">
      <text class="cuIcon-loading loading-icon"></text>
      <text>加载更多</text>
    </view>
  </scroll-view>

  <!-- 空状态 -->
  <view class="empty-state" wx:if="{{joinedEvents.length === 0}}">
    <text class="cuIcon-emoji xl"></text>
    <text class="empty-text">还没有参加活动呢~</text>
    <button class="create-button" bindtap="goToCreate">
      <text class="cuIcon-add"></text>
      <text>创建新活动</text>
    </button>
  </view>

  <!-- 悬浮创建按钮 -->
  <view class="fab" wx:if="{{joinedEvents.length > 0}}" bindtap="goToCreate">
    <text class="cuIcon-add"></text>
  </view>
</view> 